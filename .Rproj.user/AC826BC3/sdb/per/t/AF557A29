{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Airbnb Dashboard\"\noutput: \n  flexdashboard::flex_dashboard:\n    orientation: row\n    source_code: embed\nruntime: shiny\n---\n\n```{r setup, include=FALSE}\nlibrary(flexdashboard)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(stringr)\nlibrary(forcats)\nlibrary(viridis)\n\nlibrary(plotly)\n\nlibrary(shiny)\n```\n\n```{r import_data}\nairbnb_data = read_csv(\"nyc_airbnb.csv\") %>%\n  clean_names() %>%\n  #mutate(rating = review_scores_location / 2) %>%\n  #select(boro = neighbourhood_group, neighbourhood, rating, price, room_type,\n         #latitude, longitude) %>%\n  filter(!is.na(rating))  \n\n```\n\nColumn {.sidebar}\n-----------------------------------------------------------------------\nThis `flexdashboard` with Shiny was made for [Jeff Goldsmith's Data Science I class](http://jeffgoldsmith.com/DSI/index.html) in the Department of Biostatistics at Columbia University. The data come from [Inside Airbnb](http://insideairbnb.com/about.html), which provides Airbnb data from different cities, and this dashboard focuses on NYC. Download the data used for this app [here](http://jeffgoldsmith.com/DSI/dataset_airbnb.html).\n\n```{r}\nboros = airbnb_data %>% distinct(boro) %>% pull()\n\n# selectInput widget\nselectInput(\"boro_choice\", label = h3(\"Select boro\"),\n            choices = boros, selected = \"Manhattan\")\n\nhr()\n\n## sliderInput widget\n# set min and max price based on boro choice\nrenderUI({\n  max_price = airbnb_data %>% filter(boro == input$boro_choice) %>% \n                           distinct(price) %>% max()\n  \n  min_price = airbnb_data %>% filter(boro == input$boro_choice) %>% \n                           distinct(price) %>% min()\n  \n  sliderInput(\"price_range\", label = h3(\"Choose price range\"), min = min_price, \n        max = max_price, value = c(100, 400))\n})\n\nhr()\n\nroom_choice = airbnb_data %>% distinct(room_type) %>% pull()\n\n# radioButtons widget\nradioButtons(\"room_choice\", label = h3(\"Choose room type\"),\n    choices = room_choice, \n    selected = \"Entire home/apt\")\n\n```\n\nRow \n-----------------------------------------------------------------------\n\n### Airbnb prices by location\n\n```{r}\nrenderPlotly({\n    airbnb_data %>%\n    filter(boro == input$boro_choice, \n           price %in% input$price_range[1]:input$price_range[2],\n           room_type == input$room_choice) %>%\n    mutate(text_label = str_c(\"Price: $\", price, '\\nRating: ', rating)) %>% \n    plot_ly(x = ~longitude, y = ~latitude, type = \"scatter\", mode = \"markers\",\n          alpha = 0.5, \n          color = ~price,\n          text = ~text_label)\n})\n\n```\n\nRow {.tabset .tabset-fade } \n-----------------------------------------------------------------------\n\n### Neighborhood popularity\n\n```{r}\n\nx <- list(\n  title = \"\",\n  tickangle = 40,\n  tickfont = list(\n    size = 8  \n  )\n)\n\ny <- list(\n  title = \"number of listings\"\n)\n\n\nrenderPlotly({\n  airbnb_data %>% \n        filter(boro == input$boro_choice, \n           price %in% input$price_range[1]:input$price_range[2],\n           room_type == input$room_choice) %>%\n    count(neighbourhood) %>% \n    mutate(neighbourhood = fct_reorder(neighbourhood, n)) %>% \n    plot_ly(x = ~neighbourhood, y = ~n, color = ~neighbourhood, type = \"bar\") %>%\n      layout(xaxis = x, yaxis = y)\n})\n```\n\n### Prices for most popular neighborhoods\n\n```{r}\nrenderPlotly({ \n  common_neighborhoods =\n    airbnb_data %>% \n    filter(boro == input$boro_choice,\n           price %in% input$price_range[1]:input$price_range[2],\n           room_type == input$room_choice) %>%\n    count(neighbourhood, sort = TRUE) %>% \n    top_n(8) %>% \n    select(neighbourhood)\n\n  airbnb_data %>%\n    filter(boro == input$boro_choice,\n                          price %in% input$price_range[1]:input$price_range[2],\n                          room_type == input$room_choice) %>%\n    inner_join(., common_neighborhoods, by = \"neighbourhood\") %>% \n    plot_ly(y = ~price, color = ~neighbourhood, type = \"box\",\n          colors = \"Set2\") %>%\n    layout(xaxis = x)\n  \n})\n\n```\n\n",
    "created" : 1509988344950.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "571578536",
    "id" : "AF557A29",
    "lastKnownWriteTime" : 1509990588,
    "last_content_update" : 1509990588770,
    "path" : "~/airbnb_dashboard/index.Rmd",
    "project_path" : "index.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}